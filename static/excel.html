<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Generatore Codice Fiscale (parte Nome/Cognome) — Template Excel</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,600,700,800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg0:#0b0f14;
      --bg1:#0e1726;
      --panel: rgba(255,255,255,.06);
      --panel2: rgba(255,255,255,.09);
      --stroke: rgba(255,255,255,.14);
      --stroke2: rgba(255,255,255,.22);

      --ink:#eaf0ff;
      --muted: rgba(234,240,255,.76);

      --accent:#ff3d9a;
      --accent2:#33f0c8;
      --gold:#ffd66e;

      --shadow: 0 18px 55px rgba(0,0,0,.52);
      --shadow2: 0 12px 40px rgba(0,0,0,.35);
      --radius: 22px;
      --radius2: 16px;

      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--ink);
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      background:
        radial-gradient(1200px 900px at 20% 15%, rgba(255,61,154,.22), transparent 62%),
        radial-gradient(900px 700px at 85% 25%, rgba(51,240,200,.18), transparent 60%),
        radial-gradient(1100px 800px at 65% 90%, rgba(255,214,110,.12), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1) 55%, #070a10);
      overflow-x:hidden;
    }

    /* Subtle grain without external assets */
    .grain{
      position:fixed; inset:0; pointer-events:none; z-index:0;
      background-image:
        repeating-linear-gradient(0deg, rgba(255,255,255,.03) 0 1px, transparent 1px 2px),
        repeating-linear-gradient(90deg, rgba(0,0,0,.03) 0 1px, transparent 1px 2px);
      mix-blend-mode: overlay;
      opacity:.35;
      transform: translateZ(0);
    }

    header{
      position:relative;
      z-index:1;
      padding: clamp(18px, 3.5vw, 38px) clamp(16px, 4vw, 52px) 0;
    }

    nav{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
    }

    .brand{
      display:flex; align-items:center; gap:12px;
      min-width: 220px;
    }
    .mark{
      width:42px; height:42px; border-radius:14px;
      background:
        radial-gradient(16px 16px at 30% 30%, rgba(255,255,255,.25), transparent 60%),
        conic-gradient(from 210deg, rgba(255,61,154,.95), rgba(51,240,200,.9), rgba(255,214,110,.9), rgba(255,61,154,.95));
      box-shadow: 0 12px 35px rgba(0,0,0,.45);
      border:1px solid rgba(255,255,255,.12);
      position:relative;
      overflow:hidden;
    }
    .mark::after{
      content:"";
      position:absolute; inset:-40%;
      background: radial-gradient(circle at 40% 40%, rgba(255,255,255,.16), transparent 55%);
      transform: rotate(18deg);
    }
    .brand h1{
      margin:0;
      font-family: Fraunces, serif;
      font-weight: 800;
      letter-spacing: .2px;
      font-size: 18px;
      line-height: 1.05;
    }
    .brand p{
      margin:0;
      color:var(--muted);
      font-size: 12px;
      letter-spacing:.2px;
    }

    .pill{
      display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end;
    }
    .pill a{
      text-decoration:none;
      color:var(--ink);
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      padding:10px 12px;
      border-radius:999px;
      font-size:12.5px;
      letter-spacing:.2px;
      backdrop-filter: blur(10px);
      transition: transform .2s ease, border-color .2s ease, background .2s ease;
      box-shadow: 0 10px 24px rgba(0,0,0,.18);
      white-space:nowrap;
    }
    .pill a:hover{
      transform: translateY(-2px);
      border-color: var(--stroke2);
      background: linear-gradient(180deg, rgba(255,255,255,.11), rgba(255,255,255,.05));
    }

    main{
      position:relative;
      z-index:1;
      padding: clamp(18px, 3.5vw, 38px) clamp(16px, 4vw, 52px) clamp(22px, 5vw, 64px);
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap: clamp(16px, 3vw, 28px);
      align-items:start;
    }

    @media (max-width: 980px){
      main{grid-template-columns:1fr}
      .brand{min-width:auto}
      .pill{justify-content:flex-start}
    }

    .hero{
      padding: clamp(18px, 2.8vw, 28px);
      border-radius: var(--radius);
      background:
        radial-gradient(400px 260px at 10% 0%, rgba(255,61,154,.18), transparent 65%),
        radial-gradient(380px 260px at 85% 20%, rgba(51,240,200,.16), transparent 65%),
        linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border:1px solid rgba(255,255,255,.12);
      box-shadow: var(--shadow);
      position:relative;
      overflow:hidden;
    }

    .hero::before{
      content:"";
      position:absolute;
      inset:-1px;
      background:
        radial-gradient(800px 350px at 30% 0%, rgba(255,255,255,.08), transparent 70%),
        linear-gradient(90deg, rgba(255,255,255,.06), transparent 30%, transparent 70%, rgba(255,255,255,.06));
      opacity:.9;
      pointer-events:none;
      mix-blend-mode: overlay;
    }

    .kicker{
      display:inline-flex;
      gap:10px;
      align-items:center;
      padding:8px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.18);
      backdrop-filter: blur(10px);
      font-size:12.5px;
      color: var(--muted);
      letter-spacing:.2px;
      position:relative;
      z-index:1;
    }
    .dot{
      width:9px; height:9px; border-radius:50%;
      background: radial-gradient(circle at 35% 35%, rgba(255,255,255,.55), rgba(255,255,255,.06));
      border:1px solid rgba(255,255,255,.18);
      box-shadow: 0 0 0 3px rgba(255,61,154,.12);
    }

    .hero h2{
      margin: 14px 0 10px;
      font-family: Fraunces, serif;
      font-weight: 800;
      letter-spacing:-.4px;
      font-size: clamp(28px, 3.6vw, 44px);
      line-height:1.05;
      position:relative;
      z-index:1;
    }
    .hero p{
      margin:0 0 18px;
      color: var(--muted);
      font-size: 15.5px;
      line-height: 1.55;
      max-width: 62ch;
      position:relative;
      z-index:1;
    }

    .gridCards{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      position:relative;
      z-index:1;
    }
    @media (max-width: 560px){
      .gridCards{grid-template-columns:1fr}
    }

    .card{
      border-radius: var(--radius2);
      padding: 14px 14px 13px;
      border: 1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.035));
      box-shadow: var(--shadow2);
      transition: transform .22s ease, border-color .22s ease, background .22s ease;
      position:relative;
      overflow:hidden;
    }
    .card:hover{
      transform: translateY(-3px);
      border-color: rgba(255,255,255,.22);
      background: linear-gradient(180deg, rgba(255,255,255,.09), rgba(255,255,255,.04));
    }
    .card h3{
      margin:0 0 6px;
      font-family: Fraunces, serif;
      font-weight:700;
      letter-spacing:-.2px;
      font-size: 16px;
    }
    .card p{
      margin:0;
      color: var(--muted);
      font-size: 13px;
      line-height:1.45;
    }

    .panel{
      border-radius: var(--radius);
      background:
        radial-gradient(420px 260px at 0% 15%, rgba(51,240,200,.14), transparent 62%),
        linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border:1px solid rgba(255,255,255,.12);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .panelHeader{
      padding: 18px 18px 14px;
      border-bottom: 1px solid rgba(255,255,255,.12);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
    }
    .panelHeader h3{
      margin:0;
      font-family: Fraunces, serif;
      font-weight: 800;
      letter-spacing:-.3px;
      font-size: 18px;
      line-height:1.12;
    }
    .panelHeader p{
      margin:6px 0 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.45;
      max-width: 56ch;
    }

    .panelBody{
      padding: 16px 18px 18px;
    }

    .tabs{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .tabBtn{
      appearance:none;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      color: var(--ink);
      padding: 9px 11px;
      border-radius: 999px;
      font-size: 12.5px;
      letter-spacing:.2px;
      cursor:pointer;
      transition: transform .15s ease, background .2s ease, border-color .2s ease;
      user-select:none;
    }
    .tabBtn:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.24); }
    .tabBtn[aria-selected="true"]{
      background: linear-gradient(180deg, rgba(255,61,154,.22), rgba(255,61,154,.08));
      border-color: rgba(255,61,154,.35);
    }

    .codeBlock{
      margin-top: 14px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      overflow:hidden;
      background: rgba(0,0,0,.28);
    }

    pre{
      margin:0;
      padding: 14px 14px 12px;
      overflow:auto;
      font-family: var(--mono);
      font-size: 12.25px;
      line-height: 1.55;
      color: rgba(234,240,255,.92);
      tab-size: 2;
      white-space: pre;
    }

    .toolbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding: 10px 12px;
      border-top: 1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      gap:10px;
    }
    .hint{
      color: var(--muted);
      font-size: 12px;
      line-height:1.3;
    }

    .btn{
      appearance:none;
      border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.05));
      color: var(--ink);
      padding: 9px 12px;
      border-radius: 12px;
      cursor:pointer;
      font-size: 12.5px;
      letter-spacing:.15px;
      transition: transform .15s ease, border-color .2s ease, filter .2s ease;
      box-shadow: 0 10px 24px rgba(0,0,0,.22);
      white-space:nowrap;
    }
    .btn:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.25); filter: brightness(1.06); }
    .btn:active{ transform: translateY(0px) scale(.99); }
    .btn.primary{
      border-color: rgba(51,240,200,.35);
      background: linear-gradient(180deg, rgba(51,240,200,.22), rgba(51,240,200,.08));
    }

    .note{
      margin-top: 14px;
      padding: 14px 14px;
      border-radius: 18px;
      border: 1px dashed rgba(255,214,110,.35);
      background: linear-gradient(180deg, rgba(255,214,110,.12), rgba(255,214,110,.04));
      color: rgba(234,240,255,.86);
      font-size: 13px;
      line-height: 1.5;
    }
    .note strong{ color: rgba(255,255,255,.95); }

    footer{
      position:relative;
      z-index:1;
      padding: 0 clamp(16px, 4vw, 52px) 28px;
      color: var(--muted);
      font-size: 12.5px;
      line-height:1.5;
    }

    /* reveal */
    .reveal{opacity:0; transform: translateY(14px); filter: blur(2px);}
    .reveal.in{opacity:1; transform:none; filter:none; transition: opacity .7s ease, transform .7s ease, filter .7s ease;}
    .stagger > *{opacity:0; transform: translateY(10px);}
    .stagger.in > *{opacity:1; transform:none; transition: opacity .7s ease, transform .7s ease;}
    .stagger.in > *:nth-child(1){transition-delay:.05s}
    .stagger.in > *:nth-child(2){transition-delay:.12s}
    .stagger.in > *:nth-child(3){transition-delay:.19s}
    .stagger.in > *:nth-child(4){transition-delay:.26s}
  </style>
</head>

<body>
  <div class="grain" aria-hidden="true"></div>

  <header>
    <nav class="reveal">
      <div class="brand" aria-label="Titolo">
        <div class="mark" aria-hidden="true"></div>
        <div>
          <h1>Excel CF — Nome & Cognome</h1>
          <p>Estrazione consonanti/vocali con fallback (3 → 2 → 1)</p>
        </div>
      </div>
      <div class="pill" aria-label="Scorciatoie">
        <a href="#formule">Formule pronte</a>
        <a href="#come">Come usarlo</a>
        <a href="#test">Test rapido</a>
      </div>
    </nav>
  </header>

  <main>
    <section class="hero reveal" aria-labelledby="hero-title">
      <div class="kicker">
        <span class="dot" aria-hidden="true"></span>
        <span>Obiettivo: ottenere le 3 lettere per <strong>NOME</strong> e <strong>COGNOME</strong> (parte del Codice Fiscale)</span>
      </div>

      <h2 id="hero-title">Formule Excel che “capiscono” quante consonanti hai.</h2>
      <p>
        Ti preparo un sistema in Excel che estrae le consonanti dal nome (o cognome) e, se non arrivano a 3,
        completa con le vocali. Se ancora non basta, riempie con <strong>X</strong>.
        Include anche la regola speciale del <strong>nome con 4+ consonanti</strong> (si prendono 1ª, 3ª, 4ª).
      </p>

      <div class="gridCards stagger" id="come">
        <article class="card">
          <h3>Regola standard (cognome)</h3>
          <p>Prendi le prime 3 consonanti; se mancano, aggiungi vocali; se mancano ancora, “X”.</p>
        </article>
        <article class="card">
          <h3>Regola speciale (nome)</h3>
          <p>Se il nome ha 4+ consonanti: usa 1ª + 3ª + 4ª; altrimenti regola standard.</p>
        </article>
        <article class="card">
          <h3>Gestione nomi composti</h3>
          <p>Le formule rimuovono spazi e caratteri non alfabetici (in modo ragionevole) e lavorano in maiuscolo.</p>
        </article>
        <article class="card">
          <h3>Compatibilità</h3>
          <p>Versione consigliata: Excel 365 (funzioni dinamiche). Se vuoi, posso adattarle anche a Excel 2016/2019.</p>
        </article>
      </div>

      <div class="note" role="note">
        <strong>Nota importante:</strong> qui generiamo solo le 3 lettere di <strong>Nome</strong> e <strong>Cognome</strong>.
        Per il Codice Fiscale completo servono anche data di nascita, sesso, codice comune e carattere di controllo.
        Se vuoi, posso estendere il file per calcolare tutto il CF.
      </div>
    </section>

    <aside class="panel reveal" id="formule" aria-label="Formule Excel">
      <div class="panelHeader">
        <div>
          <h3>Formule pronte da incollare</h3>
          <p>
            Scegli il tab in base a ciò che ti serve: <strong>COGNOME</strong> (standard) o <strong>NOME</strong> (con regola 4 consonanti).
            Inserisci il testo in <strong>A2</strong>.
          </p>
        </div>
        <div class="tabs" role="tablist" aria-label="Selezione formula">
          <button class="tabBtn" role="tab" aria-selected="true" aria-controls="tab-cognome" id="btn-cognome">Cognome</button>
          <button class="tabBtn" role="tab" aria-selected="false" aria-controls="tab-nome" id="btn-nome">Nome</button>
        </div>
      </div>

      <div class="panelBody">
        <section id="tab-cognome" role="tabpanel" aria-labelledby="btn-cognome">
          <div class="codeBlock" aria-label="Formula Cognome">
<pre id="code-cognome">=LET(
  t; MAIUSC(SOSTITUISCI(A2;" ";""));
  chars; TESTO.DIVIDI(t;;"");
  v; {"A";"E";"I";"O";"U"};
  isLetter; (CODICE(chars)&gt;=65)*(CODICE(chars)&lt;=90);
  letters; FILTRA(chars; isLetter);
  cons; FILTRA(letters; NON(È.NUMERO(CONFRONTA(letters; v; 0))));
  voc; FILTRA(letters; È.NUMERO(CONFRONTA(letters; v; 0)));
  base; SINISTRA(TESTO.UNISCI("");cons)&TESTO.UNISCI("");voc)&"XXX";3);
  base
)</pre>
            <div class="toolbar">
              <div class="hint">Incolla in B2. Funziona anche se il cognome ha 2 o 1 consonante.</div>
              <button class="btn primary" data-copy="#code-cognome">Copia</button>
            </div>
          </div>
        </section>

        <section id="tab-nome" role="tabpanel" aria-labelledby="btn-nome" hidden>
          <div class="codeBlock" aria-label="Formula Nome">
<pre id="code-nome">=LET(
  t; MAIUSC(SOSTITUISCI(A2;" ";""));
  chars; TESTO.DIVIDI(t;;"");
  v; {"A";"E";"I";"O";"U"};
  isLetter; (CODICE(chars)&gt;=65)*(CODICE(chars)&lt;=90);
  letters; FILTRA(chars; isLetter);
  cons; FILTRA(letters; NON(È.NUMERO(CONFRONTA(letters; v; 0))));
  voc; FILTRA(letters; È.NUMERO(CONFRONTA(letters; v; 0)));
  nC; RIGHE(cons);
  standard; SINISTRA(TESTO.UNISCI("");cons)&TESTO.UNISCI("");voc)&"XXX";3);
  speciale; SINISTRA(INDICE(cons;1)&INDICE(cons;3)&INDICE(cons;4);3);
  SE(nC>=4; speciale; standard)
)</pre>
            <div class="toolbar">
              <div class="hint">Incolla in B2. Se 4+ consonanti applica 1ª+3ª+4ª, altrimenti fallback.</div>
              <button class="btn primary" data-copy="#code-nome">Copia</button>
            </div>
          </div>
        </section>

        <div class="note" id="test">
          <strong>Test rapido:</strong> metti in A2 un nome/cognome (es. “Lia”, “Io”, “Ng”, “Cristina”, “De Luca”) e guarda B2.
          Se vuoi gestire anche apostrofi/accents (es. “D’Angelo”, “Niccolò”), dimmi la tua versione di Excel e ti preparo una variante.
        </div>
      </div>
    </aside>
  </main>

  <footer class="reveal" aria-label="Footer">
    <p>
      Vuoi che questo diventi un vero “sistema” Excel con colonne (Nome, Cognome, Data, Sesso, Comune) e output del Codice Fiscale completo?
      Dimmi: <strong>versione Excel</strong> (365/2019/2016), se hai l’elenco dei <strong>codici catastali</strong> e se ti serve anche il <strong>carattere di controllo</strong>.
    </p>
  </footer>

  <script>
    // Tabs
    const btnC = document.getElementById('btn-cognome');
    const btnN = document.getElementById('btn-nome');
    const tabC = document.getElementById('tab-cognome');
    const tabN = document.getElementById('tab-nome');

    function activate(which){
      const isC = which === 'c';
      btnC.setAttribute('aria-selected', String(isC));
      btnN.setAttribute('aria-selected', String(!isC));
      tabC.hidden = !isC;
      tabN.hidden = isC;
    }
    btnC.addEventListener('click', ()=>activate('c'));
    btnN.addEventListener('click', ()=>activate('n'));

    // Copy buttons
    async function copyFrom(selector){
      const el = document.querySelector(selector);
      const text = el ? el.innerText : '';
      try{
        await navigator.clipboard.writeText(text);
      }catch(e){
        // fallback
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        ta.remove();
      }
    }

    document.querySelectorAll('[data-copy]').forEach(btn=>{
      btn.addEventListener('click', async ()=>{
        const sel = btn.getAttribute('data-copy');
        const old = btn.textContent;
        await copyFrom(sel);
        btn.textContent = 'Copiato';
        setTimeout(()=>btn.textContent = old, 900);
      });
    });

    // IntersectionObserver reveal
    const obs = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{
        if(e.isIntersecting){
          e.target.classList.add('in');
          obs.unobserve(e.target);
        }
      });
    }, {threshold: 0.12});

    document.querySelectorAll('.reveal, .stagger').forEach(el=>obs.observe(el));
  </script>
</body>
</html>