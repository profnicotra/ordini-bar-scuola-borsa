<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Coda Ordini ‚Äî Bar Scuola Borsa</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&family=Playfair+Display:ital,wght@1,700&display=swap" rel="stylesheet"/>
<style>
*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }
:root { --red:#e63946; --dark:#080404; }
body {
  font-family:'Montserrat',sans-serif;
  background:
    radial-gradient(ellipse at 10% 20%, rgba(110,30,30,0.22) 0%, transparent 50%),
    radial-gradient(ellipse at 90% 80%, rgba(70,15,15,0.18) 0%, transparent 50%),
    linear-gradient(135deg,#0a0404 0%,#120505 50%,#0d0404 100%);
  min-height:100vh; color:white; overflow-x:hidden;
}
body::before {
  content:""; position:fixed; inset:0; pointer-events:none; z-index:0;
  background-image:radial-gradient(circle at 1px 1px,rgba(255,255,255,0.022) 1px,transparent 0);
  background-size:28px 28px;
}

/* HEADER */
.site-header {
  position:sticky; top:0; z-index:100;
  background:linear-gradient(180deg,rgba(6,6,6,0.98),rgba(10,3,3,0.95));
  backdrop-filter:blur(24px);
  border-bottom:1px solid rgba(230,57,70,0.15);
  box-shadow:0 8px 40px rgba(0,0,0,0.7);
  padding:0 40px; height:80px;
  display:flex; align-items:center; justify-content:space-between;
}
.site-header::before {
  content:""; position:absolute; top:0; left:0; right:0; height:2px;
  background:linear-gradient(90deg,transparent,#e63946 25%,#ff8080 50%,#e63946 75%,transparent);
  opacity:0.7;
}
.header-logo { display:flex; align-items:center; gap:12px; }
.header-logo img { width:46px; height:46px; object-fit:contain; filter:drop-shadow(0 0 6px rgba(230,57,70,0.3)); }
.header-logo-divider { width:1px; height:26px; background:rgba(255,255,255,0.15); }
.header-logo-text { display:flex; flex-direction:column; line-height:1.15; }
.header-logo-text .ls { font-size:9px; font-weight:400; letter-spacing:3px; text-transform:uppercase; color:rgba(255,255,255,0.35); }
.header-logo-text .lm { font-size:13px; font-weight:800; letter-spacing:2px; text-transform:uppercase; color:white; }
.header-center {
  position:absolute; left:50%; transform:translateX(-50%);
  font-family:'Playfair Display',serif; font-size:20px; font-weight:700; font-style:italic; color:white;
}
.header-right { display:flex; align-items:center; gap:10px; }
.live-badge {
  display:flex; align-items:center; gap:7px;
  padding:7px 14px; border-radius:20px;
  background:rgba(74,222,128,0.1); border:1px solid rgba(74,222,128,0.25);
  font-size:10px; font-weight:800; letter-spacing:2px; text-transform:uppercase; color:#4ade80;
}
.live-dot { width:7px; height:7px; border-radius:50%; background:#4ade80; box-shadow:0 0 8px rgba(74,222,128,0.9); animation:pulseDot 2s infinite; }
@keyframes pulseDot { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:0.6;transform:scale(1.4)} }

/* COUNTERS */
.count-bar {
  position:relative; z-index:1;
  padding:22px 40px 0;
  display:flex; align-items:center; gap:10px; flex-wrap:wrap;
}
.count-chip {
  display:flex; align-items:center; gap:7px;
  padding:7px 14px; border-radius:20px;
  font-size:11px; font-weight:700; letter-spacing:1px; text-transform:uppercase;
}
.chip-nuovo { background:rgba(230,57,70,0.1); border:1px solid rgba(230,57,70,0.22); color:#ff8080; }
.chip-prep  { background:rgba(251,191,36,0.1); border:1px solid rgba(251,191,36,0.22); color:#fbbf24; }
.chip-pronto{ background:rgba(74,222,128,0.1); border:1px solid rgba(74,222,128,0.22); color:#4ade80; }
.chip-num   { font-size:14px; font-weight:800; }

/* GRID */
.queue-grid {
  position:relative; z-index:1;
  padding:22px 40px 60px;
  display:grid; grid-template-columns:repeat(3,1fr); gap:20px;
}

/* ORDER CARD */
.order-card {
  background:rgba(18,6,6,0.88); backdrop-filter:blur(16px);
  border:1px solid rgba(255,255,255,0.09); border-radius:20px;
  overflow:hidden; position:relative;
  box-shadow:0 8px 32px rgba(0,0,0,0.5);
  transition:transform 0.25s ease, box-shadow 0.25s ease;
  animation:cardIn 0.4s ease both;
}
@keyframes cardIn { from{opacity:0;transform:translateY(14px)} to{opacity:1;transform:translateY(0)} }
.order-card:hover { transform:translateY(-4px); box-shadow:0 16px 48px rgba(0,0,0,0.6); }

/* coloured left stripe */
.order-card.s-nuovo::before  { content:""; position:absolute; top:0; left:0; bottom:0; width:3px; background:#e63946; }
.order-card.s-prep::before   { content:""; position:absolute; top:0; left:0; bottom:0; width:3px; background:#fbbf24; }
.order-card.s-pronto::before { content:""; position:absolute; top:0; left:0; bottom:0; width:3px; background:#4ade80; box-shadow:0 0 10px rgba(74,222,128,0.4); }

/* Card top */
.card-top {
  padding:18px 20px 14px;
  display:flex; align-items:flex-start; justify-content:space-between;
  border-bottom:1px solid rgba(255,255,255,0.06);
}
.card-id    { font-size:10px; font-weight:800; letter-spacing:3px; text-transform:uppercase; color:rgba(255,255,255,0.28); margin-bottom:4px; }
.card-name  { font-size:17px; font-weight:800; color:white; line-height:1.2; }
.card-place { font-size:12px; color:rgba(255,255,255,0.4); font-weight:600; margin-top:3px; }
.card-meta  { display:flex; flex-direction:column; align-items:flex-end; gap:6px; flex-shrink:0; }
.status-badge { font-size:10px; font-weight:800; letter-spacing:1.5px; text-transform:uppercase; padding:4px 10px; border-radius:20px; white-space:nowrap; }
.b-nuovo  { background:rgba(230,57,70,0.12); border:1px solid rgba(230,57,70,0.28); color:#ff8080; }
.b-prep   { background:rgba(251,191,36,0.12); border:1px solid rgba(251,191,36,0.28); color:#fbbf24; }
.b-pronto { background:rgba(74,222,128,0.12); border:1px solid rgba(74,222,128,0.28); color:#4ade80; }
.card-time { font-size:11px; color:rgba(255,255,255,0.26); font-weight:600; }

/* Card body */
.card-body { padding:14px 20px; }
.order-item {
  display:flex; align-items:center; justify-content:space-between;
  padding:9px 12px; margin-bottom:7px;
  background:rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.08); border-radius:10px;
}
.order-item:last-child { margin-bottom:0; }
.item-left { display:flex; flex-direction:column; gap:3px; }
.item-name { font-size:14px; font-weight:700; color:white; }
.item-nota { font-size:11px; color:#ff9090; font-style:italic; }
.item-qty {
  font-size:13px; font-weight:800; color:white; flex-shrink:0;
  background:rgba(230,57,70,0.14); border:1px solid rgba(230,57,70,0.24);
  width:30px; height:30px; border-radius:8px; display:flex; align-items:center; justify-content:center;
}

/* Card footer */
.card-footer {
  padding:12px 20px 18px;
  border-top:1px solid rgba(255,255,255,0.06);
}
.footer-total { font-size:20px; font-weight:800; color:white; margin-bottom:12px; }
.footer-total .sym { font-size:13px; vertical-align:super; color:rgba(255,255,255,0.45); margin-right:1px; }
.action-row { display:flex; gap:8px; }
.btn-act {
  flex:1; padding:10px 6px; border-radius:10px; border:none;
  font-family:'Montserrat',sans-serif; font-size:11px; font-weight:800;
  letter-spacing:1px; text-transform:uppercase; cursor:pointer;
  transition:all 0.25s ease; display:flex; align-items:center; justify-content:center; gap:5px;
}
.btn-prep   { background:rgba(251,191,36,0.12); border:1px solid rgba(251,191,36,0.28); color:#fbbf24; }
.btn-pronto { background:rgba(74,222,128,0.12); border:1px solid rgba(74,222,128,0.28); color:#4ade80; }
.btn-del    { background:rgba(230,57,70,0.1);   border:1px solid rgba(230,57,70,0.25);  color:#ff8080; flex:0 0 36px; }
.btn-act:hover { transform:translateY(-2px); filter:brightness(1.15); }
.btn-act:disabled { opacity:0.3; cursor:not-allowed; transform:none !important; filter:none !important; }

/* EMPTY */
.empty-state {
  grid-column:1/-1; text-align:center;
  padding:80px 20px; display:flex; flex-direction:column; align-items:center; gap:14px;
}
.empty-icon { font-size:52px; opacity:0.22; }
.empty-text { font-size:17px; font-weight:700; color:rgba(255,255,255,0.28); }
.empty-sub  { font-size:13px; color:rgba(255,255,255,0.15); }

/* Scrollbar */
::-webkit-scrollbar { width:6px; }
::-webkit-scrollbar-track { background:rgba(255,255,255,0.03); }
::-webkit-scrollbar-thumb { background:rgba(230,57,70,0.35); border-radius:4px; }

/* RESPONSIVE */
@media (max-width:1100px) { .queue-grid { grid-template-columns:repeat(2,1fr); } }
@media (max-width:700px) {
  .site-header { padding:0 20px; }
  .header-center { display:none; }
  .count-bar { padding:16px 20px 0; }
  .queue-grid { padding:16px 20px 40px; grid-template-columns:1fr; }
}
@media (max-width:480px) {
  .header-logo-text .ls { display:none; }
}
</style>
</head>
<body>

<!-- HEADER -->
<header class="site-header">
  <div class="header-logo">
    <img src="https://raw.githubusercontent.com/Rashmika274/ordini-bar-scuola-borsa/main/static/logo.png" alt="Logo">
    <div class="header-logo-divider"></div>
    <div class="header-logo-text">
      <span class="ls">Sala &amp; Bar</span>
      <span class="lm">Scuola Borsa</span>
    </div>
  </div>
  <div class="header-center">Coda Ordini</div>
  <div class="header-right">
    <div class="live-badge"><div class="live-dot"></div>Live</div>
  </div>
</header>

<!-- COUNTERS -->
<div class="count-bar">
  <div class="count-chip chip-nuovo"><span class="chip-num" id="cnt-nuovo">0</span>&nbsp;Nuovi</div>
  <div class="count-chip chip-prep"><span class="chip-num" id="cnt-prep">0</span>&nbsp;In preparazione</div>
  <div class="count-chip chip-pronto"><span class="chip-num" id="cnt-pronto">0</span>&nbsp;Pronti</div>
</div>

<!-- ORDERS -->
<main class="queue-grid" id="orders-container">

  {% if queue %}
    {% for ordine in queue %}
    <div class="order-card s-nuovo">
      <div class="card-top">
        <div>
          <div class="card-id">Ordine #{{ ordine.id }}</div>
          <div class="card-name">{{ ordine.utente }}</div>
          <div class="card-place">üìç {{ ordine.posizione }}</div>
        </div>
        <div class="card-meta">
          <span class="status-badge b-nuovo">Nuovo</span>
          <span class="card-time">{{ ordine.creato_il }}</span>
        </div>
      </div>

      <div class="card-body">
        {% for item in ordine['items'] %}
        <div class="order-item">
          <div class="item-left">
            <span class="item-name">{{ item.prodotto }}</span>
            {% if item.nota %}
              <span class="item-nota">üìù {{ item.nota }}</span>
            {% endif %}
          </div>
          <div class="item-qty">√ó{{ item.quantita }}</div>
        </div>
        {% endfor %}
      </div>

      <div class="card-footer">
        <div class="footer-total"><span class="sym">‚Ç¨</span>{{ "%.2f"|format(ordine.totale_euro) }}</div>
        <div class="action-row">
          <button class="btn-act btn-prep"   onclick="setStatus(this,'prep')"  >üî• Prep</button>
          <button class="btn-act btn-pronto" onclick="setStatus(this,'pronto')">‚úì Pronto</button>
          <button class="btn-act btn-del"    onclick="removeCard(this)"        >üóë</button>
        </div>
      </div>
    </div>
    {% endfor %}
  {% else %}
    <div class="empty-state">
      <div class="empty-icon">üìã</div>
      <div class="empty-text">Nessun ordine in coda</div>
      <div class="empty-sub">Gli ordini appariranno qui non appena arrivano</div>
    </div>
  {% endif %}

</main>

<script>
function updateCounts() {
  document.getElementById('cnt-nuovo').textContent  = document.querySelectorAll('.order-card.s-nuovo').length;
  document.getElementById('cnt-prep').textContent   = document.querySelectorAll('.order-card.s-prep').length;
  document.getElementById('cnt-pronto').textContent = document.querySelectorAll('.order-card.s-pronto').length;
}

function setStatus(btn, status) {
  const card  = btn.closest('.order-card');
  const badge = card.querySelector('.status-badge');
  const btnPrep   = card.querySelector('.btn-prep');
  const btnPronto = card.querySelector('.btn-pronto');

  card.classList.remove('s-nuovo','s-prep','s-pronto');
  badge.classList.remove('b-nuovo','b-prep','b-pronto');

  if (status === 'prep') {
    card.classList.add('s-prep');
    badge.classList.add('b-prep');
    badge.textContent = 'In preparazione';
    btnPrep.disabled  = true;
    btnPronto.disabled = false;
  } else {
    card.classList.add('s-pronto');
    badge.classList.add('b-pronto');
    badge.textContent  = 'Pronto';
    btnPrep.disabled   = true;
    btnPronto.disabled = true;
  }
  updateCounts();
}

function removeCard(btn) {
  const card = btn.closest('.order-card');
  card.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
  card.style.opacity    = '0';
  card.style.transform  = 'scale(0.92) translateY(-6px)';
  setTimeout(() => { card.remove(); updateCounts(); }, 300);
}

updateCounts();

// auto-refresh ogni 30s
setTimeout(() => location.reload(), 30000);
</script>

</body>
</html>